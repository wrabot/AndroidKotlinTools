# Android Kotlin Tools

Set of tools that I use in my Android projects.
NB1: Old version used RX but since coroutines, live data, flows are well defined, I migrate and simplify my tools.
NB2: data binding will be replaced by view binding for list in future releases.

They are split in modules to avoid including all dependencies and permissions

## installation

Add the following repository

    repositories {
        maven { url 'https://jitpack.io' }
    }
    
Add the needed dependencies (just one or several)

    dependencies {
        implementation 'com.github.wrabot.AndroidKotlinTools:tools-persistent:1.0'
        implementation 'com.github.wrabot.AndroidKotlinTools:tools-viewbinding:1.0'
        implementation 'com.github.wrabot.AndroidKotlinTools:tools-databinding:1.0'
    }
    
## tools-persistent
Needs no dependencies or permissions

**SharedPreferencesManager**: map kotlin properties to SharedPreferences easily.

With extended this class, kotlin properties can maps the shared preferences content.
```kotlin
class MyPreferencesManager(context: Context) : SharedPreferencesManager(context.getSharedPreferences("SharedPrefs", Context.MODE_PRIVATE)) {
    var myString by StringDelegate()
    var myInt by IntDelegate()
    var myBool by BooleanDelegate()
}
```

In this example myString, myInt, myBool are retrieved and stored automatically in shared preferences with this names.

## tools-viewbinding
Needs view binding

**SimpleListAdapter**: use easily recycler views with adapter and LiveData for one item type

This adapter allows automatic updates through LiveData and easy item provisioning with view binding

The item POJO :
```kotlin
data class Item(val text : String) {
    fun bind(binding: ItemBinding) {
        binding.text.text = text
    }
}
```

The item layout described :
```xml
<android.support.v7.widget.CardView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:layout_margin="5dp"
    android:foreground="?attr/selectableItemBackground"
    app:cardCornerRadius="4dp">
        <TextView
            android:id="@+id/text"
            android:layout_width="match_parent"
            android:layout_height="50dp"/>
</android.support.v7.widget.CardView>
```

The following method are generated by view binding:
- ItemBinding::inflate (generated for every binding class) is used to inflates item

The livedata which will provided data in view model
```kotlin
val data = MutableLiveData<List<Item>>()
```

Once, define the adapter
```kotlin
recyclerView.adapter = SimpleListAdapter(ItemBinding::inflate, Item::bind).apply {
    viewModel.data.observe(this) {submitList(it)}
    onClick = { item, position, view -> println("$item at $position in $view is clicked") }
}
```

**MultiListAdapter**: use easily recycler views with adapter and LiveData for several item type

This adapter allows automatic updates through LiveData and easy item provisioning with view binding

The item layout described with data binding :

The item 1 POJO :
```kotlin
data class Item1(val text : String) {
    fun bind(binding: ItemBinding) {
        binding.text.text = text
    }
}
```

The item 1 layout described :
```xml
<TextView
    android:id="@+id/text"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"/>
```

The item 2 POJO :
```kotlin
data class Item2(val image : Drawable) {
    fun bind(binding: ItemBinding) {
        binding.image.setImageDrawable(image)
    }
}
```

The item 2 layout described :
```xml
<ImageView
    android:id="@+id/image"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"/>
```

The item declarations with content, inflate method, and bind method :
```kotlin
data class Item1(content : Item1) : MultiListAdapter.Item<Item1>(content, Item1Binding::inflate, Item1::bind)
data class Item2(content : Item2) : MultiListAdapter.Item<Item2>(content, Item2Binding::inflate, Item2::bind)
```

Once, define the adapter
```kotlin
recyclerVew.adapter = MultiListAdapter()
```

Update adapter a list of Item1 and/or Item2
```kotlin
adapter.submitList(listOf(item1a, item2a, item1b))
```
## tools-databinding
Needs data binding

**SimpleListAdapter**: use easily recycler views with adapter and LiveData for one item type

This adapter allows automatic updates through LiveData and easy item provisioning with data binding

The item POJO :
```kotlin
data class Item(val title : String, val id : Long)
```

The item layout described with data binding :
```xml
<layout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    tools:keep="@layout/item">

    <data>
        <variable
            name="item"
            type="com.example.Item"/>
    </data>

    <android.support.v7.widget.CardView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:layout_margin="5dp"
        android:foreground="?attr/selectableItemBackground"
        app:cardCornerRadius="4dp">
            <TextView
                android:layout_width="match_parent"
                android:layout_height="50dp"
                android:text="@{item.title}"/>
    </android.support.v7.widget.CardView>
</layout>
```

The following methods are generated by data binding:
- ItemBinding::inflate (generated for every binding class) is used to inflates item
- ItemBinding::setItem (generated by the variable tag) is used to bind item data

The livedata which will provided data in view model
```kotlin
val data = MutableLiveData<List<Item>>()
```

Once, define the adapter
```kotlin
recyclerView.adapter = SimpleListAdapter(ItemBinding::inflate, ItemBinding::setItem).apply {
    viewModel.data.observe(this) {submitList(it)}
    onClick = { item, position, view -> println("$item at $position in $view is clicked") }
}
```

**MultiListAdapter**: use easily recycler views with adapter and LiveData for several item type

This adapter allows automatic updates through LiveData and easy item provisioning with data binding

The item layout described with data binding :

- layout item1
```xml
<layout>

    <data>
        <variable
            name="item1"
            type="com.example.Item1"/>
    </data>

    ...

</layout>
```

- layout item2
```xml
<layout>

    <data>
        <variable
            name="item2"
            type="com.example.Item2"/>
    </data>

    ...

</layout>
```

The item declarations with content, layout Id, and variable Id for data binding :
```kotlin
data class Item1(content : Item1) : MultiListAdapter.Item<Item1>(content, R.layout.item1, BR.item1)
data class Item2(content : Item2) : MultiListAdapter.Item<Item2>(content, R.layout.item2, BR.item2)
```

Once, define the adapter
```kotlin
recyclerVew.adapter = MultiListAdapter()
```

Update adapter a list of Item1 and/or Item2
```kotlin
adapter.submitList(listOf(item1a, item2a, item1b))
```
